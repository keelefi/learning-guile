# 05-records-again

In this exercise we use the SRFI-9 Record we created in the previous exercise. However, this time, instead of using
getters and setters generated by the record definition, we use separate functions exposed from our C program to
manipulate the record.

Currently, the code does not work. It fails as follows:

    $ ./05-records-again
    (make-employee-impl name age salary position))
    hello from file!
    name: Backtrace:
    In ice-9/boot-9.scm:
      1736:10  3 (with-exception-handler _ _ #:unwind? _ # _)
    In unknown file:
               2 (apply-smob/0 #<thunk 55c8a6ed4ac0>)
    In ice-9/eval.scm:
       191:35  1 (_ #f)
    In unknown file:
               0 (get_employee_name #<employee name: "Joe" age: 55 salar?>)

    ERROR: In procedure get_employee_name:
    Wrong type to apply: #<syntax-transformer employee-name>

However, if the functions generated by the record definition are not used directly, but instead, proxy functions are
introduced, the code works.

The `diff` to get the code to work is as follows:

    --- a/05-records-again/script.scm
    +++ b/05-records-again/script.scm
    @@ -5,10 +5,16 @@
     (define-record-type employee
         (make-employee-impl name age salary position)
         employee?
    -    (name       employee-name)
    -    (age        employee-age)
    -    (salary     employee-salary     set-employee-salary!)
    -    (position   employee-position))
    +    (name       employee-name-impl)
    +    (age        employee-age-impl)
    +    (salary     employee-salary-impl        set-employee-salary-impl!)
    +    (position   employee-position-impl))
    +
    +(define (employee-name employee) (employee-name-impl employee))
    +(define (employee-age employee) (employee-age-impl employee))
    +(define (employee-salary employee) (employee-salary-impl employee))
    +(define (employee-position employee) (employee-position-impl employee))
    +(define (set-employee-salary! employee salary) (set-employee-salary-impl! employee salary))
    
     (define* (make-employee name age #:key (salary 3000) (position "developer"))
         (make-employee-impl name age salary position))

## Compiling

The project should contain the following files:

    $ ls
    05-records-again.c configure.ac Makefile.in README.md script.scm

Use `autoconf` to create `configure`:

    $ autoreconf -vif configure.ac

Run `configure`:

    $ ./configure

Use make to compile and link `05-records-again`:

    $ make

## Running

After compiling `05-records-again`, run it:

    $ ./05-records-again
